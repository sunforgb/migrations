# План швейцарские часы

1. Развернуть инфру в докере - Done
2. Придумать свой тип данных и привязать к джанге, RND - Done, user_type сделан через enum
3. Прописать models для api согласно схеме с прошлого семестра, ориентироваться на заметки в телефоне - Done
4. Написать api - Done, ждет тестов 
5. Предусмотреть роли по аналогии с barbershops - Done
6. Написать триггеры, которые будут вызывать функции, написанные на plpython - DONE
6.1 Зполнить данными БД и проверить работу политик (политики тоже написать) - DONE
7. Через процедуры и представления генерировать отчеты - DONE
8. Перевод заявок из статуса обработки в статус обработано/отклонена через транзакции с savepoint - DONE// вызывать процедуру для перевода? -
9. Написать на скорую руку front. - In Progress

## Планы по фронту:

1. Отображение заявок в двух таблицах - Done
2. Заявки в статусе pending отображаются для сотрудников, в статусе aproval для начальников, в других - для аналитиков - in Progress (фильтрация). - Done
3. CRUD?
4. Сотрудник меняет статус заявки по кнопке, может даже в CRUD.
5. Начальник же меняет статус заявки по кнопке запросом к API. После чего идет проверка какую запись менять. После чего идет update в транзакции -> смена статуса заявки и при необходимости смена статуса мигранта (registered/unregistered)
Таким образом получаем хоть что-то за транзакции с savepoint.
6. После оформления делаем authRequired и делаем setRole по типу юзера. Fail, перешел к курсору во вьюхах


Не думаю что нужно делать что-то еще. Этого должно хватить.
Пришлось отказаться от использования middleware (портила запрос и отдавало 401 (ХЗ ПОЧЕМУ ЕБАЛА)).
Делаем через cursor SET ROLE уже в самих viewsets и тогда нормально будет. Правда придется переопределить уже все методы.

Вторник - доделать курсор в вьюхах и сделать транзакции. сделать небольшой CRUD и поиграться. После этого можно сдавать отчет.
